# Linux Setup Scripts

このプロジェクトは、LinuxのCLIで使用するツールであり、Linuxのセットアップや簡単なコマンドの実行を手助けするメニューベースのインターフェースを提供します。

## 概要

本ツールは、`menu.yaml` ファイルで定義された階層的なメニュー構造を通じて、各種コマンドや初期設定を簡単に実行できるように設計されています。Pythonで実装されており、CLIだけでなくWebインターフェースからも操作可能です。

## 主な機能

*   **階層化メニュー:** `menu.yaml` を使用して、メニューを階層化し、ユーザーが直感的に操作できるようにします。
*   **初回セットアップスクリプト (`setup.sh`):** 必要なPythonモジュール（`PyYAML`, `Flask`）のインストールと、`menu` コマンドの作成を自動化します。
*   **GitHub CLI (`gh`) インストール:** GitHub CLIのインストールをメニューから実行できます。
*   **Samba共有管理:** Samba共有の追加、削除をメニューから簡単に行えます。
*   **Webインターフェース:** Flask を使用したWebサーバーを提供し、ブラウザからメニューの操作やコマンドの実行が可能です。`menu.yaml` からメニューデータを読み込み、JSON APIとして提供します。

## 構成ファイル

*   `menu.py`: メインのPythonスクリプト。CLIおよびWebインターフェースからのコマンド実行を処理します。
*   `menu.yaml`: メニュー構造と実行するコマンドを定義する設定ファイル。
*   `setup.sh`: プロジェクトの初期セットアップスクリプト。
*   `webmenu.py`: Webインターフェースを提供するFlaskアプリケーション。
*   `templates/index.html`: Webインターフェースのフロントエンドテンプレート。

## 使用方法

1.  `setup.sh` を実行して、必要な依存関係をインストールし、`menu` コマンドを設定します。
2.  CLIから `menu` コマンドを実行するか、`webmenu.py` を起動してWebブラウザからアクセスします。

## インストール

### Gitのインストール

Linuxディストリビューションに応じて、以下のコマンドでGitをインストールできます。

*   **Debian/Ubuntu:**
    ```bash
    sudo apt update
    sudo apt install git
    ```
*   **Fedora:**
    ```bash
    sudo dnf install git
    ```
*   **CentOS/RHEL:**
    ```bash
    sudo yum install git
    ```

### リポジトリのクローン

Gitがインストールされたら、以下のコマンドでこのリポジトリをクローンできます。

```bash
git clone https://github.com/Coush3/LinuxSetup.Scripts.git
cd LinuxSetup.Scripts
```

### セットアップスクリプトの実行

リポジトリをクローンしたら、以下のコマンドでセットアップスクリプトを実行します。これにより、必要なPythonモジュールのインストールと、`menu` コマンドが設定されます。

```bash
./setup.sh
```

### メニューの実行

セットアップが完了したら、以下のいずれかの方法でメニューを実行できます。

*   **CLIから実行:**
    ```bash
    menu
    ```
*   **Webインターフェースから実行:**
    ```bash
    python3 webmenu.py
    ```
    Webサーバーが起動したら、ブラウザで `http://localhost:5000` (または表示されたURL) にアクセスしてください。

### リポジトリの更新

リポジトリを最新の状態に更新するには、以下のコマンドを実行します。

```bash
./update
```

または、手動で `git pull` を実行することもできます。

```bash
git pull
```

### ファイアウォール設定 (ufw)

Code Server (ポート8080) や VS Code Webサーバー (ポート8000) などのWebサービスを外部から利用する場合、ファイアウォールで該当ポートを開放する必要があります。本ツールにはファイアウォール設定を管理するメニューがありますが、手動で設定する場合は以下のコマンドを参考にしてください。

*   **ufwのステータス確認:**
    ```bash
    sudo ufw status
    ```
*   **ポートを開放する (例: 8080ポート):**
    ```bash
    sudo ufw allow 8080/tcp
    ```
*   **ポートを閉じる (例: 8080ポート):**
    ```bash
    sudo ufw deny 8080/tcp
    ```

ファイアウォールが有効になっていない場合は、`sudo ufw enable` で有効にできますが、SSH接続が切断される可能性があるため注意してください。

### Webメニューのセキュリティに関する注意

Webメニューは、リモートからシェルコマンドを実行できる機能を提供します。これは非常に強力な機能である反面、セキュリティ上のリスクを伴います。本ツールは開発・テスト用途を想定しており、**本番環境での利用は推奨されません。**

特に以下の点にご注意ください。

*   **入力値の検証:** 現在、ユーザーからの入力は直接シェルコマンドに渡される可能性があります。悪意のある入力（シェルインジェクションなど）を防ぐためには、厳密な入力値の検証が必要です。
*   **HTTPSの利用:** パスワードやその他の機密情報がネットワーク上を平文で流れるのを防ぐため、HTTPSの利用を強く推奨します。これは、Webメニューの前にNginxなどのリバースプロキシを設定することで実現できます。
*   **最小権限の原則:** Webメニューを実行するユーザーの権限は、必要最小限に制限すべきです。`sudo` の設定（`sudoers`）を適切に管理し、許可されたコマンドのみが実行されるようにしてください。

## 開発状況

現在、CLIとWebインターフェースの両方で基本的な機能が実装されています。今後のタスクとして、CLIインタラクティブ入力の再調整、CLI引数解析の強化、Webメニューのセキュリティ強化、エラーハンドリングとユーザーフィードバックの改善が挙げられます。
